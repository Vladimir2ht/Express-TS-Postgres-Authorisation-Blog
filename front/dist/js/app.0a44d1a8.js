(function(){"use strict";var e={4284:function(e,t,n){var a=n(9242),o=n(3396);function i(e,t,n,a,i,r){const l=(0,o.up)("Main");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(l)])}var r=n(7139);function l(e,t,n,a,i,l){const u=(0,o.up)("Input"),s=(0,o.up)("InputPassword"),d=(0,o.up)("Modal"),c=(0,o.up)("Button"),p=(0,o.up)("Textarea"),f=(0,o.up)("Radio"),h=(0,o.up)("DeleteOutlined"),v=(0,o.up)("ListItemMeta"),m=(0,o.up)("ListItem"),g=(0,o.up)("List"),w=(0,o.up)("Card"),y=(0,o.up)("LayoutContent"),k=(0,o.up)("Layout");return(0,o.wg)(),(0,o.j4)(k,null,{default:(0,o.w5)((()=>[(0,o.Wm)(y,null,{default:(0,o.w5)((()=>[(0,o.Wm)(d,{title:"Авторизация",visible:e.visible,"confirm-loading":e.confirmLoading,cancelText:e.sign_up,okText:e.sign_in,onOk:e.handleIn,onCancel:e.handleUp},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{ref:"user",placeholder:"Basic usage"},null,512),(0,o.Wm)(s,{placeholder:"Basic usage"})])),_:1},8,["visible","confirm-loading","cancelText","okText","onOk","onCancel"]),(0,o.Wm)(w,null,{title:(0,o.w5)((()=>[(0,o.Wm)(c,{onClick:e.newPost,type:"primary"},{default:(0,o.w5)((()=>[(0,o.Uk)("Добавить пост")])),_:1},8,["onClick"]),(0,o.Wm)(c,{onClick:t[0]||(t[0]=t=>e.newPost(e.e,!0)),type:"primary"},{default:(0,o.w5)((()=>[(0,o.Uk)("Изменить пост")])),_:1}),(0,o.Uk)(" "+(0,r.zw)(e.selectedPostDate),1)])),extra:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)(e.login),1)])),default:(0,o.w5)((()=>[(0,o.Wm)(p,{ref:"text","auto-size":"",placeholder:"Пост с текстом"},null,512),(0,o.Wm)(u,{ref:"file",type:"file",placeholder:"Пост с файлом",max:1},null,512),(0,o.Wm)(g,{onChange:e.selectPost,pagination:e.pagination,"data-source":e.listData,"item-layout":"vertical",size:"large"},{renderItem:(0,o.w5)((({item:t})=>[(0,o.Wm)(m,{key:"item.id"},(0,o.Nv)({default:(0,o.w5)((()=>[(0,o.Wm)(v,{description:t.date_created},{title:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)(t.user_name),1)])),_:2},1032,["description"]),(0,o.Uk)(" "+(0,r.zw)(t.body),1)])),_:2},[t.user_name===e.login?{name:"extra",fn:(0,o.w5)((()=>[(0,o.Wm)(f,{value:t.id,checked:t.checked},null,8,["value","checked"]),(0,o.Wm)(c,{type:"primary",shape:"circle",danger:"",onClick:n=>e.deletePost(t.id),size:e.small},{icon:(0,o.w5)((()=>[(0,o.Wm)(h)])),_:2},1032,["onClick","size"])])),key:"0"}:void 0]),1024)])),_:1},8,["onChange","pagination","data-source"])])),_:1})])),_:1})])),_:1})}var u=n(4870),s=n(8232),d=n(9321),c=n(2782),p=n(6988),f=n(326),h=n(3943),v=n(898),m=n(3428),g=n(9814),w=n(4587),y=n(2821),k=n(1587),P=n(430);const b={onChange:e=>{console.log(e)},pageSize:20};let _;const O=(0,u.iH)([]),x=(0,u.iH)(""),C=(0,u.iH)(0),Z=(0,u.iH)(!0),W=(0,u.iH)(!1);var I=(0,o.aZ)({name:"Main",components:{Layout:s.ZP,LayoutContent:s.bU,Card:d.ZP,List:c.ZP,ListItem:p.Z,ListItemMeta:f.Z,Modal:h.Z,Button:v.Z,Input:m.ZP,InputPassword:g.Z,Textarea:w.Z,RadioGroup:y.Z,Radio:k.ZP,DeleteOutlined:P.Z},data(){return{sign_up:"Регистрация",sign_in:"Авторизация",small:"small"}},setup(){return{login:x,selectedPost:C,listData:O,pagination:b,visible:Z,confirmLoading:W}},computed:{selectedPostDate(){return C.value?O.value[C.value].date_created:""}},methods:{async getPosts(){let e=await fetch("http://vladimir2ht.ddns.net:4000/posts/",{method:"GET",headers:{Origin:"vladimir2ht.ddns.net:4000"}});O.value=(await e.json()).map((e=>(e.checked=!1,e))),console.log(O.value)},async newPost(e,t=!1){const n=new FormData;n.append("file",this.$refs.file.input.files[0]),n.append("text",this.$refs.text.resizableTextArea.textArea.value),t&&n.append("id",O.value[C.value].id.toString()),await fetch("http://vladimir2ht.ddns.net:4000/posts/",{method:t?"PATCH":"PUT",headers:{Origin:"vladimir2ht.ddns.net:4000",Authorization:"Bearer "+_},body:n}),await this.getPosts()},async selectPost(e){if("radio"!==e.target.type)return;console.log(e.target.value);let t=O.value.findIndex((t=>t.id==e.target.value));console.log(t),O.value[C.value].checked=!1,C.value=t,O.value[t].checked=!0,O.value=[...O.value],console.log(C.value)},async deletePost(e){await fetch("http://vladimir2ht.ddns.net:4000/posts?id="+e,{method:"delete",headers:{Origin:"vladimir2ht.ddns.net:4000",Authorization:"Bearer "+_}}),await this.getPosts()},async authRequest(e){W.value=!0;const t={name:this.$refs.user.input.value},n=document.querySelector('input[type="password"]');if(t.password=n?n.value:document.querySelectorAll("input")[1].value,!t.name||!t.password)return W.value=!1;console.log(t);const a=await fetch("http://vladimir2ht.ddns.net:4000/auth/"+e,{method:"post",body:JSON.stringify(t),headers:{Origin:"http://localhost:8080/","Content-type":"application/json"}}).then((e=>205===e.status?(W.value=!1,{token:!1}):e.json()));console.log(a),a.token&&(_=a.token,x.value=t.name,W.value=!1,Z.value=!1,setTimeout((()=>{Z.value=!0}),6e5))},async handleIn(){this.authRequest("log")},async handleUp(){this.authRequest("reg")}},mounted(){this.getPosts()}}),T=n(89);const z=(0,T.Z)(I,[["render",l],["__scopeId","data-v-004982f5"]]);var L=z,j=(0,o.aZ)({name:"App",components:{Main:L}});const U=(0,T.Z)(j,[["render",i]]);var D=U;n(2467);(0,a.ri)(D).mount("#app")}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,n),i.exports}n.m=e,function(){var e=[];n.O=function(t,a,o,i){if(!a){var r=1/0;for(d=0;d<e.length;d++){a=e[d][0],o=e[d][1],i=e[d][2];for(var l=!0,u=0;u<a.length;u++)(!1&i||r>=i)&&Object.keys(n.O).every((function(e){return n.O[e](a[u])}))?a.splice(u--,1):(l=!1,i<r&&(r=i));if(l){e.splice(d--,1);var s=o();void 0!==s&&(t=s)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[a,o,i]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,i,r=a[0],l=a[1],u=a[2],s=0;if(r.some((function(t){return 0!==e[t]}))){for(o in l)n.o(l,o)&&(n.m[o]=l[o]);if(u)var d=u(n)}for(t&&t(a);s<r.length;s++)i=r[s],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(d)},a=self["webpackChunkfont"]=self["webpackChunkfont"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[998],(function(){return n(4284)}));a=n.O(a)})();
//# sourceMappingURL=app.0a44d1a8.js.map