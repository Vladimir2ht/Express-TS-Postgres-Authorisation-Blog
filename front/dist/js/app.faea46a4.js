(function(){"use strict";var e={6757:function(e,t,n){var a=n(9242),o=n(3396);function i(e,t,n,a,i,r){const l=(0,o.up)("Main");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(l)])}var r=n(7139);const l={key:0},s=["src"],u={key:2,controls:"controls"},c=["src"],d={key:3,controls:"controls"},p=["src"];function f(e,t,n,a,i,f){const h=(0,o.up)("Input"),v=(0,o.up)("InputPassword"),m=(0,o.up)("Modal"),g=(0,o.up)("Button"),y=(0,o.up)("Textarea"),w=(0,o.up)("Radio"),k=(0,o.up)("DeleteOutlined"),_=(0,o.up)("ListItemMeta"),b=(0,o.up)("ListItem"),P=(0,o.up)("List"),x=(0,o.up)("Card"),O=(0,o.up)("LayoutContent"),C=(0,o.up)("Layout");return(0,o.wg)(),(0,o.j4)(C,null,{default:(0,o.w5)((()=>[(0,o.Wm)(O,null,{default:(0,o.w5)((()=>[(0,o.Wm)(m,{title:"Авторизация",visible:e.visible,"confirm-loading":e.confirmLoading,cancelText:e.sign_up,okText:e.sign_in,onOk:e.handleIn,onCancel:e.handleUp},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{ref:"user",placeholder:"Введите имя пользователя"},null,512),(0,o.Wm)(v,{placeholder:"Введите пароль"})])),_:1},8,["visible","confirm-loading","cancelText","okText","onOk","onCancel"]),(0,o.Wm)(x,null,{title:(0,o.w5)((()=>[(0,o.Wm)(g,{onClick:e.newPost,type:"primary"},{default:(0,o.w5)((()=>[(0,o.Uk)("Добавить пост")])),_:1},8,["onClick"]),(0,o.Wm)(g,{onClick:t[0]||(t[0]=t=>e.newPost(e.e,!0)),type:"primary"},{default:(0,o.w5)((()=>[(0,o.Uk)("Изменить пост")])),_:1}),(0,o.Uk)(" "+(0,r.zw)(e.selectedPostDate),1)])),extra:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)(e.login),1)])),default:(0,o.w5)((()=>[(0,o.Wm)(y,{ref:"text","auto-size":"",placeholder:"Пост с текстом"},null,512),(0,o.Wm)(h,{ref:"file",type:"file",placeholder:"Пост с файлом",max:1},null,512),(0,o.Wm)(P,{onChange:e.selectPost,pagination:e.pagination,"data-source":e.listData,"item-layout":"vertical",size:"large"},{renderItem:(0,o.w5)((({item:t})=>[(0,o.Wm)(b,{key:"item.id"},(0,o.Nv)({default:(0,o.w5)((()=>[(0,o.Wm)(_,{description:t.date_created},{title:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)(t.user_name),1)])),_:2},1032,["description"]),"text"===t.content_type?((0,o.wg)(),(0,o.iD)("span",l,(0,r.zw)(t.body),1)):t.content_type.includes("image")?((0,o.wg)(),(0,o.iD)("img",{key:1,src:t.body},null,8,s)):t.content_type.includes("video")?((0,o.wg)(),(0,o.iD)("video",u,[(0,o._)("source",{src:t.body},null,8,c)])):t.content_type.includes("audio")?((0,o.wg)(),(0,o.iD)("audio",d,[(0,o._)("source",{src:t.body},null,8,p)])):(0,o.kq)("",!0)])),_:2},[t.user_name===e.login?{name:"extra",fn:(0,o.w5)((()=>[(0,o.Wm)(w,{value:t.id,checked:t.checked},null,8,["value","checked"]),(0,o.Wm)(g,{type:"primary",shape:"circle",danger:"",onClick:n=>e.deletePost(t.id),size:e.small},{icon:(0,o.w5)((()=>[(0,o.Wm)(k)])),_:2},1032,["onClick","size"])])),key:"0"}:void 0]),1024)])),_:1},8,["onChange","pagination","data-source"])])),_:1})])),_:1})])),_:1})}var h=n(4870),v=n(8232),m=n(9321),g=n(2782),y=n(6988),w=n(326),k=n(3943),_=n(898),b=n(3428),P=n(9814),x=n(4587),O=n(9665),C=n(430);const W={onChange:e=>{console.log(e)},pageSize:20};let Z;const I=(0,h.iH)([]),T=(0,h.iH)(""),z=(0,h.iH)(0),D=(0,h.iH)(!0),L=(0,h.iH)(!1);var j=(0,o.aZ)({name:"Main",components:{Layout:v.ZP,LayoutContent:v.bU,Card:m.ZP,List:g.ZP,ListItem:y.Z,ListItemMeta:w.Z,Modal:k.Z,Button:_.Z,Input:b.ZP,InputPassword:P.Z,Textarea:x.Z,Radio:O.ZP,DeleteOutlined:C.Z},data(){return{sign_up:"Регистрация",sign_in:"Авторизация",small:"small"}},setup(){return{login:T,selectedPost:z,listData:I,pagination:W,visible:D,confirmLoading:L}},computed:{selectedPostDate(){return z.value?I.value[z.value].date_created:""}},methods:{async getPosts(){let e=await fetch("http://vladimir2ht.ddns.net:4000/posts/",{method:"GET",headers:{Origin:"vladimir2ht.ddns.net:4000"}});I.value=(await e.json()).map((e=>(e.checked=!1,e))),console.log(I.value)},async newPost(e,t=!1){const n=new FormData;n.append("file",this.$refs.file.input.files[0]),n.append("text",this.$refs.text.resizableTextArea.textArea.value),t&&n.append("id",I.value[z.value].id.toString()),await fetch("http://vladimir2ht.ddns.net:4000/posts/",{method:t?"PATCH":"PUT",headers:{Origin:"vladimir2ht.ddns.net:4000",Authorization:"Bearer "+Z},body:n}),await this.getPosts()},async selectPost(e){if("radio"!==e.target.type)return;console.log(e.target.value);let t=I.value.findIndex((t=>t.id==e.target.value));console.log(t),I.value[z.value].checked=!1,z.value=t,I.value[t].checked=!0,I.value=[...I.value],console.log(z.value)},async deletePost(e){await fetch("http://vladimir2ht.ddns.net:4000/posts?id="+e,{method:"delete",headers:{Origin:"vladimir2ht.ddns.net:4000",Authorization:"Bearer "+Z}}),await this.getPosts()},async authRequest(e){L.value=!0;const t={name:this.$refs.user.input.value},n=document.querySelector('input[type="password"]');if(t.password=n?n.value:document.querySelectorAll("input")[1].value,!t.name||!t.password)return L.value=!1;console.log(t);const a=await fetch("http://vladimir2ht.ddns.net:4000/auth/"+e,{method:"post",body:JSON.stringify(t),headers:{Origin:"http://localhost:8080/","Content-type":"application/json"}}).then((e=>205===e.status?(L.value=!1,{token:!1}):e.json()));console.log(a),a.token&&(Z=a.token,T.value=t.name,L.value=!1,D.value=!1,setTimeout((()=>{D.value=!0}),6e5))},async handleIn(){this.authRequest("log")},async handleUp(){this.authRequest("reg")}},mounted(){this.getPosts()}}),U=n(89);const M=(0,U.Z)(j,[["render",f],["__scopeId","data-v-12ad1078"]]);var A=M,q=(0,o.aZ)({name:"App",components:{Main:A}});const H=(0,U.Z)(q,[["render",i]]);var R=H;n(2467);(0,a.ri)(R).mount("#app")}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,n),i.exports}n.m=e,function(){var e=[];n.O=function(t,a,o,i){if(!a){var r=1/0;for(c=0;c<e.length;c++){a=e[c][0],o=e[c][1],i=e[c][2];for(var l=!0,s=0;s<a.length;s++)(!1&i||r>=i)&&Object.keys(n.O).every((function(e){return n.O[e](a[s])}))?a.splice(s--,1):(l=!1,i<r&&(r=i));if(l){e.splice(c--,1);var u=o();void 0!==u&&(t=u)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[a,o,i]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,i,r=a[0],l=a[1],s=a[2],u=0;if(r.some((function(t){return 0!==e[t]}))){for(o in l)n.o(l,o)&&(n.m[o]=l[o]);if(s)var c=s(n)}for(t&&t(a);u<r.length;u++)i=r[u],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(c)},a=self["webpackChunkfont"]=self["webpackChunkfont"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[998],(function(){return n(6757)}));a=n.O(a)})();
//# sourceMappingURL=app.faea46a4.js.map